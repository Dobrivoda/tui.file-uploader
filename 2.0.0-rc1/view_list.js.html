

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Source: view/list.js | Tree</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/bootstrap.min.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-jsdoc.css">
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/tui-doc.css">

    
</head>
<body>
<nav class="lnb" id="lnb">
    <div class="logo" style="width: 150px">
        <img src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" width="100%" height="100%">
    </div>
    <div class="title">
        <h1><a href="index.html" class="link">Tree</a></h1>
        
    </div>
    <div class="search-container" id="search-container">
        <input type="text" placeholder="Search">
        <ul></ul>
    </div>
    
        <ol class="lnb-tab">
            <li id="api-tab">
                <a href="#"><h4>API</h4></a>
            </li>
            <li id="examples-tab">
                <a href="#"><h4>Examples</h4></a>
            </li>
        </ol>
    
    <div class="lnb-examples hidden"><h3>Examples</h3><ul><li><a href="tutorial-example1.html">1. Normal transfer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example1_sub"></div></li><li><a href="tutorial-example2.html">2. Batch transfer</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example2_sub"></div></li><li><a href="tutorial-example3.html">3. Select folder</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example3_sub"></div></li><li><a href="tutorial-example4.html">4. Simple list UI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example4_sub"></div></li><li><a href="tutorial-example5.html">5. Table list UI</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example5_sub"></div></li><li><a href="tutorial-example6.html">6. Use dropzone</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example6_sub"></div></li><li><a href="tutorial-example7.html">7. Customize view</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example7_sub"></div></li><li><a href="tutorial-example8.html">8. Test all features in local</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="example8_sub"></div></li></ul></div><div class="lnb-api hidden"><h3>Classes</h3><ul><li><a href="Uploader.html">Uploader</a><button type="button" class="hidden toggle-subnav btn btn-link">  <span class="glyphicon glyphicon-plus"></span></button><div class="hidden" id="Uploader_sub"><div class="member-type">Methods</div><ul class="inner"><li><a href="Uploader.html#getCheckedTotalCount">getCheckedTotalCount</a></li><li><a href="Uploader.html#getCheckedTotalSize">getCheckedTotalSize</a></li><li><a href="Uploader.html#getUploadedTotalCount">getUploadedTotalCount</a></li><li><a href="Uploader.html#getUploadedTotalSize">getUploadedTotalSize</a></li><li><a href="Uploader.html#removeCheckedList">removeCheckedList</a></li></ul></div></li></ul></div>
</nav>
<div id="resizer"></div>

<div class="main" id="main">
    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileoverview FileListView listing files and display states(like size, count).
 * @author NHN Ent. FE Development Lab &lt;dl_javascript@nhnent.com>
 */
'use strict';

var utils = require('../utils');
var Item = require('./item');
var consts = require('../consts');

var classNames = consts.className;
var snippet = tui.util;
var forEach = snippet.forEach;
var isUndefined = snippet.isUndefined;
var isArraySafe = snippet.isArraySafe;

/**
 * List view
 * @class List
 * @param {jQuery} $el - Container element to generate list view
 * @param {object} options - Options to set list view
 *     @param {object} options.listType - List type ('simple' or 'table')
 *     @param {string} [options.item] - To customize item contents when list type is 'simple'
 *     @param {array.&lt;object>} [options.columnList] - To customize row contents when list type is 'table'
 * @ignore
 */
var List = tui.util.defineClass(/** @lends List.prototype */{
    init: function($el, options) {
        /**
         * jQuery-element of list container
         * @type {jQuery}
         */
        this.$el = $el;

        /**
         * jQuery-element of list
         * @type {jQuery}
         */
        this.$list = null;

        /**
         * jQuery-element of checkbox in header
         * @type {jQuery}
         */
        this.$checkbox = null;

        /**
         * List type
         * @type {string}
         */
        this.listType = options.type;

        /**
         * Item template preset of simple list
         * @type {string}
         */
        this.item = options.item;

        /**
         * Item template preset of table
         * @type {Array.&lt;Object>}
         */
        this.columnList = options.columnList;

        /**
         * Item's template in list
         * @type {string}
         */
        this.itemTemplate = null;

        /**
         * Items
         * @type {Array.&lt;Item>}
         */
        this.items = [];

        this._render();
        this._addEvent();
    },

    /**
     * Render list view
     * @private
     */
    _render: function() {
        var isTableList = (this.listType === 'table');
        var $listContainer = this._getListContainer(isTableList);

        this.$el.append($listContainer);

        if (isTableList) {
            this._setTableWidth($listContainer);
            this._setColumnGroup();
            this._setTableHeader();
            this._setTableRowTemplate();
        } else {
            this._setListItemTemplate();
        }

        this.$list = this.$el.find('.' + classNames.LIST_ITEMS_CONTAINER);
        this.$checkbox = this.$el.find(':checkbox');
    },

    /**
     * Add event on checkbox
     * @private
     */
    _addEvent: function() {
        if (this.$checkbox) {
            this.$checkbox.on('change', $.proxy(this._onChange, this));
        }
    },

    /**
     * Change event handler
     * @private
     */
    _onChange: function() {
        var state = !!this.$checkbox.prop('checked');

        this._changeCheckboxInItem(state);
        this._changeCheckboxInHeader(state);
    },

    /**
     * Get container element of list
     * @param {boolean} isTableList - Whether list type is "table" or not
     * @returns {jQuery} List container
     * @private
     */
    _getListContainer: function(isTableList) {
        var template = isTableList ? consts.tableTemplate : consts.listTemplate;

        return $(utils.template({
            listItemsClassName: classNames.LIST_ITEMS_CONTAINER
        }, template.CONTAINER));
    },

    /**
     * Set width of table
     * @param {jQuery} $listContainer - List container element
     * @private
     */
    _setTableWidth: function($listContainer) {
        var columns = this.columnList;
        var totalWidth = parseInt($listContainer.width(), 10);
        var sumWidth = 0;
        var emptyCount = 0;

        forEach(columns, function(column) {
            if (column.width) {
                sumWidth += column.width;
            } else {
                emptyCount += 1;
            }
        });

        if (columns) {
            this._setEmptyWidth(totalWidth - sumWidth, emptyCount);
        }
    },

    /**
     * Set empty width value
     * @param {number} extraWidth - Extra width value
     * @param {number} emptyCount - Empty width count
     * @private
     */
    _setEmptyWidth: function(extraWidth, emptyCount) {
        var columns = this.columnList;
        var eachWidth = Math.floor(extraWidth / emptyCount);
        var lastWidth = eachWidth + (extraWidth % emptyCount);

        forEach(columns, function(column, index) {
            if (!column.width) {
                column.width = ((columns.length - 1) === index) ? lastWidth : eachWidth;
            }
        });
    },

    /**
     * Set column group in table
     * @private
     */
    _setColumnGroup: function() {
        var $colgroup = this.$el.find('colgroup');
        var columns = this.columnList;
        var html = '';

        forEach(columns, function(column) {
            html += '&lt;col width="' + column.width + '">';
        });

        if (columns) {
            $colgroup.html(html);
        }
    },

    /**
     * Set table header
     * @private
     */
    _setTableHeader: function() {
        var columns = this.columnList;
        var html = '';
        var headerCount = 0;

        forEach(columns, function(column) {
            if (!isUndefined(column.header)) {
                html += '&lt;th scope="col" width="' + column.width + '">' + column.header + '&lt;/th>';
                headerCount += 1;
            }
        });

        if (columns) {
            this._setHeaderElement(html, (headerCount === columns.length));
        }
    },

    /**
     * Set header element
     * @param {string} html - Template of header
     * @param {boolean} hasHeader - Whether has header or not
     * @private
     */
    _setHeaderElement: function(html, hasHeader) {
        var $thead = this.$el.find('thead');

        if (hasHeader) {
            html = utils.template({
                checkbox: consts.html.CHECKBOX
            }, html);
            $thead.html('&lt;tr>' + html + '&lt;/tr>');
            $thead.find('th').first().css('border-right', 0);
            $thead.find('th').last().css('border-right', 0);
        } else {
            $thead.hide();
        }
    },

    /**
     * Set row's template of table
     * @private
     */
    _setTableRowTemplate: function() {
        var columns = this.columnList;
        var html = '';

        forEach(columns, function(column) {
            html += '&lt;td width="' + column.width + '">' + column.body + '&lt;/td>';
        });

        if (html) {
            html = '&lt;tr>' + html + '&lt;/tr>';
        } else {
            html = consts.tableTemplate.LIST_ITEM;
        }

        this.itemTemplate = html;
    },

    /**
     * Set item's template of list
     * @private
     */
    _setListItemTemplate: function() {
        var item = this.item;
        var html;

        if (item) {
            html = '&lt;li>' + item + '&lt;/li>';
        } else {
            html = consts.listTemplate.LIST_ITEM;
        }

        this.itemTemplate = html;
    },

    /**
     * Set class name to list
     * @private
     */
    _setHasItemsClassName: function() {
        var className = classNames.HAS_ITEMS;
        var hasItems = !!this.items.length;

        if (hasItems) {
            this.$el.addClass(className);
        } else {
            this.$el.removeClass(className);
        }
    },

    /**
     * Set last column's width value
     */
    _setLastColumnWidth: function() {
        var lastTheadWidth = this.$el.find('th').last()[0].width;
        var scrollWidth = this.$list.width() - this.$list[0].scrollWidth;
        var lastColumWidth = lastTheadWidth - scrollWidth;

        forEach(this.items, function(item) {
            item.$el.find('td').last().attr('width', lastColumWidth);
        });
    },

    /**
     * Add file items
     * @param {object} files - Added file list
     * @private
     */
    _addFileItems: function(files) {
        if (!isArraySafe(files)) { // for target from iframe, use "isArraySafe"
            files = [files];
        }
        forEach(files, function(file) {
            this.items.push(this._createItem(file));
        }, this);
    },

    /**
     * Remove file items
     * @param {object} data - Removed item's
     * @private
     */
    _removeFileItems: function(data) {
        var removedItem;

        this.items = tui.util.filter(this.items, function(item) {
            removedItem = data[item.id];

            if (removedItem) {
                item.destroy();
            }

            return !removedItem;
        }, this);
    },

    /**
     * Create item By Data
     * @param {object} data - Data for list items
     * @returns {Item} Item
     * @private
     */
    _createItem: function(data) {
        var item = new Item(this.$list, data, this.itemTemplate);
        item.on('remove', this._onRemove, this);
        item.on('check', this._onCheck, this);

        return item;
    },

    /**
     * Remove event handler on each item
     * @param {Item} data - Remove item's data
     * @private
     */
    _onRemove: function(data) {
        this.fire('remove', data);
    },

    /**
     * Check event handler fired on each list item
     * @param {string} data - Current selected item's data
     * @param {boolean} isChecked - Checked state
     * @private
     */
    _onCheck: function(data, isChecked) {
        this._setCheckedAll();

        this.fire('check', {
            id: data.id,
            name: data.name,
            size: data.size,
            isChecked: isChecked
        });
    },

    /**
     * Set checked all state
     * @private
     */
    _setCheckedAll: function() {
        var checkedItemsId = this.getCheckedItemsId();
        var isCheckedAll = (checkedItemsId.length === this.items.length) &amp;&amp;
                            !!(this.items.length);

        this.$checkbox.prop('checked', isCheckedAll);
        this._changeCheckboxInHeader(isCheckedAll);
    },

    /**
     * Change checkbox in table header
     * @param {boolean} state - Checked state
     * @private
     */
    _changeCheckboxInHeader: function(state) {
        var $checkbox = this.$checkbox;
        var $label = utils.getLabelElement($checkbox);
        var $target = $label ? $label : $checkbox;
        var className = classNames.IS_CHECKED;

        if (state) {
            $target.addClass(className);
        } else {
            $target.removeClass(className);
        }
    },

    /**
     * Change checkbox in list item
     * @param {boolean} state - Checked state
     * @private
     */
    _changeCheckboxInItem: function(state) {
        forEach(this.items, function(item) {
            item.changeCheckboxState(state);
        });
    },

    /**
     * Get checkbox items;
     * @returns {array.&lt;Item>} Checked items
     */
    getCheckedItemsId: function() {
        var checkedIds = [];

        forEach(this.items, function(item) {
            if (item.getCheckedState()) {
                checkedIds.push(item.id);
            }
        });

        return checkedIds;
    },

    /**
     * Update item list
     * @param {object} data - File information(s) with type
     * @param {*} type - Update type
     */
    update: function(data, type) {
        if (type === 'remove') {
            this._removeFileItems(data);
        } else {
            this._addFileItems(data);
        }

        if (this.listType === 'table') {
            this._setHasItemsClassName();
            this._setCheckedAll();
            this._setLastColumnWidth();
        }
    },

    /**
     * Clear list
     */
    clear: function() {
        forEach(this.items, function(item) {
            item.destroy();
        });
        this.items.length = 0;
        this._setHasItemsClassName();
        this._setCheckedAll();
    }
});

tui.util.CustomEvents.mixin(List);

module.exports = List;
</code></pre>
        </article>
    </section>




</div>

<footer>
    <img class="logo" src="https://cloud.githubusercontent.com/assets/12269563/20029815/01133928-a39a-11e6-80f3-12500a91c755.png" style="width: 150px">
    <div class="footer-text">NHN Entertainment. Frontend Development Lab</div>
</footer>
<script>prettyPrint();</script>
<script src="scripts/jquery.min.js"></script>
<script src="scripts/tui-doc.js"></script>
<script src="scripts/linenumber.js"></script>

    <script>
        var id = '_sub'.replace(/"/g, '_');
        var selectedApi = document.getElementById(id); // do not use jquery selector
        var $selectedApi = $(selectedApi);

        $selectedApi.removeClass('hidden');
        $selectedApi.parent().find('.glyphicon').removeClass('glyphicon-plus').addClass('glyphicon-minus');
        showLnbApi();
    </script>

</body>
</html>
