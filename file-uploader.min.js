!function t(e,i,s){function n(o,r){if(!i[o]){if(!e[o]){var u="function"==typeof require&&require;if(!r&&u)return u(o,!0);if(a)return a(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return n(i?i:t)},h,h.exports,t,e,i,s)}return i[o].exports}for(var a="function"==typeof require&&require,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(t,e,i){tui.util.defineNamespace("tui.component.Uploader",t("./src/js/uploader.js"))},{"./src/js/uploader.js":7}],2:[function(t,e,i){var s={type:"POST",addRequest:function(t,e){var i=this._uploader,s=i.inputView.$el,n=tui.util.bind(this.successPadding,this,t.success);e?(this.formData=new FormData,tui.util.forEach(e,function(t){this.formData.append(i.fileField,t)},this)):this.formData=new FormData(s[0]),$.ajax({url:this._uploader.url.send,type:this.type,data:this.formData,success:n,processData:!1,contentType:!1,error:t.error})},successPadding:function(t,e){var i=JSON.parse(e),s={};s.items=i.filelist,t(s)},removeRequest:function(t){var e=tui.util.bind(this.removePadding,this,t.success);$.ajax({url:this._uploader.url.remove,data:t.data,success:e,error:t.error})},removePadding:function(t,e){var i=JSON.parse(e),s={};s.action="remove",s.name=decodeURIComponent(i.name),t(s)}};e.exports=s},{}],3:[function(t,e,i){var s=t("./ajax"),n=t("./jsonp"),a=t("./local"),o={ajax:s,jsonp:n,local:a},r={removeRequest:function(t){throw new Error("The interface removeRequest does not exist")},addRequest:function(t){throw new Error("The interface addRequest does not exist")}},u={getConnector:function(t){var e=t.type.toLowerCase(),i={_uploader:t};return tui.util.extend(i,r,o[e]||a),i}};e.exports=u},{"./ajax":2,"./jsonp":4,"./local":5}],4:[function(t,e,i){var s={addRequest:function(t){var e=this._uploader.callbackName,i=t.success;tui.util.defineNamespace(e,tui.util.bind(this.successPadding,this,i)),this._uploader.inputView.$el.submit()},successPadding:function(t,e){var i={};this._uploader.isCrossDomain()?i.items=this._getSplitItems(e):i.items=tui.util.toArray(e.filelist),t(i)},_getSplitItems:function(t){var e=this._uploader.separator,i=t.status.split(e),s=t.names.split(e),n=t.sizes.split(e),a=tui.util.isString(t.ids)?t.ids.split(e):s,o=[];return tui.util.forEach(i,function(t,e){if("success"===t){var r={name:s[e],status:i[e],size:n[e],id:a[e]};o.push(r)}}),o},removeRequest:function(t){var e=this._uploader.callbackName,i={callback:e},s=t.success;tui.util.defineNamespace(e,tui.util.bind(this.removePadding,this,s),!0),$.ajax({url:this._uploader.url.remove,dataType:"jsonp",jsonp:e,data:tui.util.extend(i,t.data)})},removePadding:function(t,e){var i={};i.action="remove",i.name=decodeURIComponent(e.name),t(i)}};e.exports=s},{}],5:[function(t,e,i){var s=t("../utils"),n={_result:null,addRequest:function(t,e){var i=s.isSupportFormData(),n=this._saveFile(i,e);t.success({items:n})},_saveFile:function(t,e){var i=this._uploader,s=i.inputView,n=s.$input[0],a=[];return this._result||(this._result=[]),t?(e=e||n.files,tui.util.forEach(e,function(t){tui.util.isObject(t)&&a.push(t)},this)):a.push({name:n.value,element:n}),this._result=this._result.concat(a),a},_makeFormData:function(){var t=this._uploader,e=t.fileField,i=t.inputView,s=new window.FormData(this._extractForm(i));return tui.util.forEach(this._result,function(t){s.append(e,t)}),s},_extractForm:function(t){var e=t.$el.clone();return e[0]},removeRequest:function(t){var e=t.data;this._result=tui.util.filter(this._result,function(t){return t.name!==e.filename}),t.success({action:"remove",name:e.filename})},submit:function(t){var e=this._makeFormData(inputView);$.ajax({url:this._uploader.url.send,type:"POST",data:e,success:t,processData:!1,contentType:!1})}};e.exports=n},{"../utils":8}],6:[function(t,e,i){e.exports.CONF={RESPONSE_TYPE:"RESPONSE_TYPE",REDIRECT_URL:"REDIRECT_URL",JSONPCALLBACK_NAME:"CALLBACK_NAME",SIZE_UNIT:"SIZE_UNIT",REMOVE_CALLBACK:"responseRemoveCallback",ERROR:{DEFAULT:"Unknown error.",NOT_SURPPORT:"This is x-domain connection, you have to make helper page."},DRAG_DEFAULT_ENABLE_CLASS:"enableClass",FILE_FILED_NAME:"userfile[]",FOLDER_INFO:"folderName"},e.exports.HTML={form:['<form enctype="multipart/form-data" id="formData" method="post">','<input type="hidden" name="MAX_FILE_SIZE" value="3000000" />',"</form>"].join(""),input:['<input type="file" id="fileAttach" {{webkitdirectory}} name="{{fileField}}" {{multiple}} />'].join(""),submit:['<button class="batchSubmit" type="submit">SEND</button>'].join(""),item:['<li class="filetypeDisplayClass">','<spna class="fileicon {{filetype}}">{{filetype}}</spna>','<span class="file_name">{{filename}}</span>','<span class="file_size">{{filesize}}</span>','<button type="button" class="{{deleteButtonClassName}}">Delete</button>',"</li>"].join(""),drag:['<div class="dragzone"></div>'].join("")}},{}],7:[function(t,e,i){var s=t("./consts"),n=t("./utils"),a=t("./connector/connector"),o=t("./view/input"),r=t("./view/list"),u=t("./view/pool"),l=t("./view/drag"),h=tui.util.defineClass({init:function(t,e){this._setData(t),this._setConnector(),this.$el=e,this.useDrag&&!this.useFolder&&n.isSupportFileSystem()&&(this.dragView=new l(t,this)),this.inputView=new o(t,this),this.listView=new r(t,this),this.fileField=this.fileField||s.CONF.FILE_FILED_NAME,this._pool=new u(this.inputView.$el[0]),this._addEvent()},_setConnector:function(){this.isBatchTransfer?this.type="local":this.isCrossDomain()?this.helper?this.type="jsonp":(alert(s.CONF.ERROR.NOT_SURPPORT),this.type="local"):this.useJsonp||!n.isSupportFormData()?this.type="jsonp":this.type="ajax",this._connector=a.getConnector(this)},notify:function(t){this.listView.update(t),this.listView.updateTotalInfo(t)},_setData:function(t){tui.util.extend(this,t)},isCrossDomain:function(){var t=document.domain;return-1===this.url.send.indexOf(t)},errorCallback:function(t){var e;e=t&&t.msg?t.msg:s.CONF.ERROR.DEFAULT,alert(e)},sendFile:function(t){var e=tui.util.bind(this.notify,this),i=t&&t.files;this._connector.addRequest({type:"add",success:function(i){t&&t.callback&&t.callback(i),e(i)},error:this.errorCallback},i)},removeFile:function(t){var e=tui.util.bind(this.notify,this);this._connector.removeRequest({type:"remove",data:t,success:e})},submit:function(){this._connector.submit&&(n.isSupportFormData()?this._connector.submit(tui.util.bind(function(){this.fire("beforesubmit",this)},this)):this._pool.plant())},_getFileInfo:function(t){var e;return e=n.isSupportFileSystem()?this._getFileList(t.files):{name:t.value,id:t.value}},_getFileList:function(t){return tui.util.map(t,function(t){return{name:t.name,size:t.size,id:t.name}})},_addEvent:function(){var t=this;this.useDrag&&this.dragView&&this.dragView.on("drop",this.sendFile,this),this.isBatchTransfer?(this.inputView.on("save",this.sendFile,this),this.listView.on("remove",this.removeFile,this)):(this.inputView.on("change",this.sendFile,this),this.listView.on("remove",this.removeFile,this)),this.listView.on("fileAdded",function(e){t.fire(e)}),this.listView.on("fileRemoved",function(e){t.fire(e)})},store:function(t){this._pool.store(t)},remove:function(t){n.isSupportFormData()||this._pool.remove(t)}});tui.util.CustomEvents.mixin(h),e.exports=h},{"./connector/connector":3,"./consts":6,"./utils":8,"./view/drag":9,"./view/input":10,"./view/list":12,"./view/pool":13}],8:[function(t,e,i){var s=function(t){var e=["B","KB","MB","GB","TB"],t=parseInt(t,10),i=Math.log(t)/Math.log(1024)|0,s=(t/Math.pow(1024,i)).toFixed(2);return s+e[i]},n=function(){var t=window.FormData||null;return!!t},a=function(t,e){return e=e.replace(/\{\{([^\}]+)\}\}/g,function(e,i){return t[i]})},o=function(){return!!(window.File&&window.FileReader&&window.FileList&&window.Blob)};e.exports={getFileSizeWithUnit:s,isSupportFileSystem:o,isSupportFormData:n,template:a}},{}],9:[function(t,e,i){var s=t("../consts"),n=(t("../utils"),tui.util.defineClass({init:function(t,e){var i=t.template&&t.template.drag||s.HTML.drag;this._enableClass=t.drag&&t.drag.enableClass||s.CONF.DRAG_DEFAULT_ENABLE_CLASS,this._render(i,e),this._addEvent()},_render:function(t,e){this.$el=$(t),e.$el.append(this.$el)},_addEvent:function(){this.$el.on("dragenter",tui.util.bind(this.onDragEnter,this)),this.$el.on("dragover",tui.util.bind(this.onDragOver,this)),this.$el.on("drop",tui.util.bind(this.onDrop,this)),this.$el.on("dragleave",tui.util.bind(this.onDragLeave,this))},onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),this._enable()},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDragLeave:function(t){t.preventDefault(),t.stopPropagation(),this._disable()},onDrop:function(t){return t.preventDefault(),this._disable(),this.fire("drop",{files:t.originalEvent.dataTransfer.files}),!1},_enable:function(){this.$el.addClass(this._enableClass)},_disable:function(){this.$el.removeClass(this._enableClass)}}));tui.util.CustomEvents.mixin(n),e.exports=n},{"../consts":6,"../utils":8}],10:[function(t,e,i){var s=t("../consts"),n=t("../utils"),a=tui.util.defineClass({init:function(t,e){this._uploader=e,this._target=t.formTarget,this._url=t.url,this._isBatchTransfer=t.isBatchTransfer,this._isMultiple=!(!n.isSupportFormData()||!t.isMultiple),this._useFolder=!(!n.isSupportFormData()||!t.useFolder),this._html=this._setHTML(t.template),this._render(),this._renderHiddenElements(),t.helper&&this._makeBridgeInfoElement(t.helper),this._addEvent()},_render:function(){this.$el=$(this._getHtml()),this.$el.attr({action:this._url.send,method:"post",enctype:"multipart/form-data",target:this._isBatchTransfer?"":this._target}),this.$input=this._getInputElement(),this.$submit=this._getSubmitElement(),this.$input.appendTo(this.$el),this.$submit&&this.$submit.appendTo(this.$el),this._uploader.$el.append(this.$el)},_setHTML:function(t){return t||(t={}),{input:t.input||s.HTML.input,submit:t.submit||s.HTML.submit,form:t.form||s.HTML.form}},_getHtml:function(){return this._html.form},_getInputElement:function(){var t={multiple:this._isMultiple?"multiple":"",fileField:this._uploader.fileField,webkitdirectory:this._useFolder?"webkitdirectory":""};return $(n.template(t,this._html.input))},_getSubmitElement:function(){return this._isBatchTransfer?$(this._html.submit):!1},_renderHiddenElements:function(){this._makeTargetFrame(),this._makeResultTypeElement(),this._makeCallbackElement()},_addEvent:function(){this._isBatchTransfer&&this.$el.on("submit",tui.util.bind(function(){this._uploader.submit()},this)),this._addInputEvent()},_addInputEvent:function(){this._isBatchTransfer?this.$input.on("change",tui.util.bind(this.onSave,this)):this.$input.on("change",tui.util.bind(this.onChange,this))},onChange:function(){this.$input[0].value&&this.fire("change",{target:this})},onSave:function(){if(this.$input[0].value){var t=n.isSupportFormData()?null:tui.util.bind(this._resetInputElement,this);this.fire("save",{element:this.$input[0],callback:t})}},_resetInputElement:function(){this.$input.off(),this._clone(this.$input[0]),this.$input=this._getInputElement(),this.$submit?this.$submit.before(this.$input):this.$el.append(this.$input),this._addInputEvent()},_makeTargetFrame:function(){this._$target=$('<iframe name="'+this._target+'"></iframe>'),this._$target.css({visibility:"hidden",position:"absolute"}),this._uploader.$el.append(this._$target)},_makeCallbackElement:function(){this._$callback=this._makeHiddenElement({name:s.CONF.JSONPCALLBACK_NAME,value:this._uploader.callbackName}),this.$el.append(this._$callback)},_makeResultTypeElement:function(){this._$resType=this._makeHiddenElement({name:this._uploader.resultTypeElementName||s.CONF.RESPONSE_TYPE,value:this._uploader.type}),this.$el.append(this._$resType)},_makeBridgeInfoElement:function(t){this._$helper=this._makeHiddenElement({name:t.name||s.CONF.REDIRECT_URL,value:t.url}),this.$el.append(this._$helper)},_makeHiddenElement:function(t){return tui.util.extend(t,{type:"hidden"}),$("<input />").attr(t)},_clone:function(t){t.file_name=t.value,this._uploader.store(t)}});tui.util.CustomEvents.mixin(a),e.exports=a},{"../consts":6,"../utils":8}],11:[function(t,e,i){var s=t("../consts"),n=t("../utils"),a=tui.util.defineClass({init:function(t){this._setRoot(t),this._setItemInfo(t),this._setConnectInfo(t),this.render(t.template||s.HTML.item),t.helper&&this._makeBridgeInfoElement(t.helper)},_setRoot:function(t){this._root=t.root,this._$root=t.root.$el},_setItemInfo:function(t){this.name=t.name,this._type=t.type||this._extractExtension(),this._id=t.id||t.name,this.size=t.size||"",this._btnClass=t.deleteButtonClassName||"uploader_btn_delete",this._unit=t.unit||"KB"},_setConnectInfo:function(t){this._url=t.url,this._hiddenInputName=t.hiddenFieldName||"filename"},render:function(t){var e=this._getHtml(t);this._$el=$(e),this._$root.append(this._$el),this._addEvent()},_extractExtension:function(){return this.name.split(".").pop()},_makeBridgeInfoElement:function(t){this.$helper=$("<input />"),this.$helper.attr({name:t.name,value:t.url})},_getHtml:function(t){var e={filetype:this._type,filename:this.name,filesize:this.size?n.getFileSizeWithUnit(this.size):"",deleteButtonClassName:this._btnClass};return n.template(e,t)},destroy:function(){this._removeEvent(),this._$el.remove()},_addEvent:function(){var t="."+this._btnClass,e=this._$el.find(t);e.on("click",tui.util.bind(this._onClickEvent,this))},_removeEvent:function(){var t="."+this._btnClass,e=this._$el.find(t);e.off("click")},_onClickEvent:function(){this.fire("remove",{filename:this.name,id:this._id,type:"remove"})}});tui.util.CustomEvents.mixin(a),e.exports=a},{"../consts":6,"../utils":8}],12:[function(t,e,i){var s=t("../utils"),n=t("./item"),a=tui.util.defineClass({init:function(t,e){var i=t.listInfo;this.items=[],this.$el=i.list,this.$counter=i.count,this.$size=i.size,this._uploader=e,tui.util.extend(this,t)},update:function(t){"remove"===t.action?this._removeFileItem(t.name):this._addFileItems(t.items)},updateTotalInfo:function(t){this._updateTotalCount(t.count),this._updateTotalUsage(t.size)},_updateTotalCount:function(t){tui.util.isExisty(t)||(t=this.items.length),this.$counter.html(t)},_updateTotalUsage:function(t){tui.util.isExisty(t)||(t=this._getSumAllItemUsage()),tui.util.isNumber(t)&&!isNaN(t)?(t=s.getFileSizeWithUnit(t),this.$size.html(t),this.$size.show()):this.$size.hide()},_getSumAllItemUsage:function(){var t=this.items,e=0;return tui.util.forEach(t,function(t){e+=parseFloat(t.size)}),e},_addFileItems:function(t){tui.util.isArray(t)||(t=[t]),tui.util.forEach(t,function(t){this.items.push(this._createItem(t))},this),this.fire("fileAdded",{target:t})},_removeFileItem:function(t){t=decodeURIComponent(t),this.items=tui.util.filter(this.items,function(e){var i=t===decodeURIComponent(e.name);return i&&(e.destroy(),this._uploader.remove(t),this.fire("fileRemoved",{name:t})),!i},this)},_createItem:function(t){var e=new n({root:this,name:t.name,size:t.size,deleteButtonClassName:this.deleteButtonClassName,url:this.url,hiddenFrame:this.formTarget,hiddenFieldName:this.hiddenFieldName,template:this.template&&this.template.item});return e.on("remove",this._removeFile,this),e},_removeFile:function(t){this.fire("remove",t)}});tui.util.CustomEvents.mixin(a),e.exports=a},{"../utils":8,"./item":11}],13:[function(t,e,i){var s=tui.util.defineClass({init:function(t){this.planet=t,this.files={},this.frag=document.createDocumentFragment()},store:function(t){this.files[t.file_name]=t,this.frag.appendChild(t)},remove:function(t){this.frag.removeChild(this.files[t]),delete this.files[t]},empty:function(){tui.util.forEach(this.files,function(t){this.remove(t.file_name)},this)},plant:function(){var t=this.planet;tui.util.forEach(this.files,function(e){t.appendChild(e),delete this.files[e.file_name]},this)}});e.exports=s},{}]},{},[1]);