!function t(i,e,s){function n(r,u){if(!e[r]){if(!i[r]){var a="function"==typeof require&&require;if(!u&&a)return a(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var h=e[r]={exports:{}};i[r][0].call(h.exports,function(t){var e=i[r][1][t];return n(e?e:t)},h,h.exports,t,i,e,s)}return e[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(t,i,e){tui.util.defineNamespace("tui.component.Uploader",t("./src/js/uploader.js"))},{"./src/js/uploader.js":6}],2:[function(t,i,e){"use strict";i.exports.CONF={SIZE_UNIT:"SIZE_UNIT",ERROR:{DEFAULT:"Unknown error."},DRAG_DEFAULT_ENABLE_CLASS:"enableClass",FILE_FILED_NAME:"userfile[]",FOLDER_INFO:"folderName",HIDDEN_FILE_INPUT_CLASS:"uploader-hidden-file-input",X_DOMAIN_GLOBAL_CALLBACK_NAME:"__uploaderXDomainCallback"},i.exports.HTML={form:['<form enctype="multipart/form-data" id="formData" method="post">','<input type="hidden" name="MAX_FILE_SIZE" value="3000000" />',"</form>"].join(""),input:['<input type="file" id="fileAttach" {{webkitdirectory}} name="{{fileField}}" {{multiple}} />'].join(""),submit:['<button class="batchSubmit" type="submit">SEND</button>'].join(""),item:['<li class="filetypeDisplayClass">','<spna class="fileicon {{filetype}}">{{filetype}}</spna>','<span class="file_name">{{filename}}</span>','<span class="file_size">{{filesize}}</span>','<button type="button" class="{{deleteButtonClassName}}">Delete</button>',"</li>"].join(""),drag:['<div class="dragzone"></div>'].join("")}},{}],3:[function(t,i,e){"use strict";var s=t("./consts").CONF.HIDDEN_FILE_INPUT_CLASS,n=tui.util.forEach,o=tui.util.hasStamp,r=tui.util.stamp,u=tui.util.defineClass({init:function(t){this.planet=t,this.files={}},store:function(t){var i,e=o(t)&&r(t);e&&(i=t.value,this.files[e+i]=t)},remove:function(t){var i=t.id+t.name,e=this.files[i];return e?(delete this.files[i],!0):!1},empty:function(){this.files={}},plant:function(){var t=this.planet;n(this.files,function(i,e){i.className=s,i.style.display="none",t.appendChild(i),delete this.files[e]},this)}});i.exports=u},{"./consts":2}],4:[function(t,i,e){"use strict";var s=tui.util.defineClass({init:function(t){this.uploader=t,this.inputView=t.inputView,this.pool=[],t.isBatchTransfer&&(this.remove=this._removeWhenBatch)},TYPE:"modern",store:function(){var t=this.pool,i=tui.util.toArray(this.inputView.$fileInput[0].files),e=tui.util.stamp,s=[];tui.util.forEach(i,function(i){var n=e(i);t.push(i),s.push({id:n,name:i.name,size:i.size})}),this.inputView.resetFileInput(),this.fire("stored",s)},upload:function(){var t,i=this.inputView.$el.clone(),e=this.uploader.fileField;i.find('input[type="file"]').remove(),t=new FormData(i),tui.util.forEach(this.pool,function(i){t.append(e,i)}),$.ajax({url:this.uploader.url.send,type:"POST",data:t,success:tui.util.bind(this._uploadSuccess,this),error:tui.util.bind(this._uploadError,this),processData:!1,contentType:!1}),this.pool.length=0},clear:function(){this.pool.length=0},_removeWhenBatch:function(t){var i=this.pool,e=tui.util.hasStamp,s=tui.util.stamp,n=!1;tui.util.forEach(i,function(o,r){return e(o)&&s(o)===t.id?(i.splice(r,1),n=!0,!1):void 0}),this.fire("removed",tui.util.extend({message:n?"success":"fail"},t))},remove:function(t){$.ajax({url:uploader.url.remove,dataType:"jsonp",data:t,success:tui.util.bind(function(t){t.type="remove",this.fire("removed",t)},this)})},_uploadError:function(t,i,e){this.fire("error",{status:i,message:e})},_uploadSuccess:function(t){this.fire("uploaded",JSON.parse(t))}});tui.util.CustomEvents.mixin(s),i.exports=s},{}],5:[function(t,i,e){"use strict";var s=t("../pool"),n=t("../consts").CONF.X_DOMAIN_GLOBAL_CALLBACK_NAME,o=tui.util.defineClass({init:function(t){var i=t.$target;this.pool=new s(t.inputView.$el[0]),this.uploader=t,this.inputView=t.inputView,i.on("load",tui.util.bind(this._onUpload,this,i)),t.isBatchTransfer&&(this.upload=this._uploadWhenBatch,this.remove=this._removeWhenBatch),t.isCrossDomain&&(window[n]=tui.util.bind(function(t){this.fire("uploaded",t)},this),this.inputView.$el.append('<input type="hidden" name="callbackName" value="'+n+'">'))},TYPE:"old",store:function(){var t=this.inputView.$fileInput[0],i=tui.util.stamp(t);this.pool.store(t),this.inputView.resetFileInput(),this.fire("stored",[{id:i,name:t.value,size:""}])},upload:function(){this.pool.plant(),this.inputView.$el.submit(),this.inputView.clear(),this.clear()},_uploadWhenBatch:function(){this.pool.plant()},remove:function(t){var i=this.uploader;$.ajax({url:i.url.remove,dataType:"jsonp",data:t,success:tui.util.bind(function(t){t.type="remove",this.fire("removed",t)},this)})},clear:function(){this.pool.empty()},_removeWhenBatch:function(t){var i=this.pool.remove(t);this.fire("removed",tui.util.extend({message:i?"success":"fail"},t))},_onUpload:function(t){var i;this.uploader.clear();try{i=t[0].contentWindow.document.body.innerHTML,i&&this.fire("uploaded",$.parseJSON(i))}catch(e){this.fire("error",{status:e.name,message:e.message})}}});tui.util.CustomEvents.mixin(o),i.exports=o},{"../consts":2,"../pool":3}],6:[function(t,i,e){"use strict";var s=t("./consts"),n=t("./utils"),o=t("./view/input"),r=t("./view/list"),u=t("./view/drag"),a=t("./requester/old"),l=t("./requester/modern"),h=tui.util.defineClass({init:function(t,i){this._setData(t),this.$el=i,this.fileField=this.fileField||s.CONF.FILE_FILED_NAME,this.useDrag&&!this.useFolder&&n.isSupportFileSystem()&&(this.dragView=new u(t,this)),this.inputView=new o(this,t),this.listView=new r(t,this),this._setConnector(),this._addEvent(),this.isCrossDomain=n.isCrossDomain(this.url.send)},_setConnector:function(){n.isSupportFormData()?this._requester=new l(this):(this.$target=this._createTargetFrame(),this.$el.append(this.$target),this._requester=new a(this))},_createTargetFrame:function(){var t=$('<iframe name="'+this.formTarget+'"></iframe>');return t.css({visibility:"hidden",position:"absolute"}),t},updateList:function(t){this.listView.update(t),this.listView.updateTotalInfo(t)},_setData:function(t){tui.util.extend(this,t)},isCrossDomain:function(){var t=document.domain;return-1===this.url.send.indexOf(t)},errorCallback:function(t){var i;i=t&&t.msg?t.msg:s.CONF.ERROR.DEFAULT,alert(i)},sendFile:function(){this._requester.store(),this._requester.upload()},removeFile:function(t){this._requester.remove(t)},submit:function(){this._requester.upload()},_getFileInfo:function(t){var i;return i=n.isSupportFileSystem()?this._getFileList(t.files):{name:t.value,id:t.value}},_getFileList:function(t){return tui.util.map(t,function(t){return{name:t.name,size:t.size,id:t.name}})},_addEvent:function(){this._requester.on("removed",function(t){this.listView.update(t),this.fire("remove",t)},this),this._requester.on("error",function(t){this.fire("error",t)},this),this.useDrag&&this.dragView&&this.dragView.on("drop",this._store,this),this.isBatchTransfer?(this.inputView.on("change",this._store,this),this.listView.on("remove",this.removeFile,this),this._requester.on({uploaded:function(t){this.clear(),this.fire("success",t)},stored:function(t){this.updateList(t),this.fire("update",t)}},this)):(this.inputView.on("change",this.sendFile,this),this.listView.on("remove",this.removeFile,this),this._requester.on({uploaded:function(t){this.updateList(t.filelist),this.fire("success",t)}},this))},clear:function(){this._requester.clear(),this.inputView.clear(),this.listView.clear()},_store:function(){this._requester.store()}});tui.util.CustomEvents.mixin(h),i.exports=h},{"./consts":2,"./requester/modern":4,"./requester/old":5,"./utils":7,"./view/drag":8,"./view/input":9,"./view/list":11}],7:[function(t,i,e){"use strict";function s(t){var i=document.createElement("a");return i.href=t,{href:i.href,host:i.host||location.host,port:"0"===i.port||""===i.port?port(i.protocol):i.port,hash:i.hash,hostname:i.hostname||location.hostname,pathname:"/"!=i.pathname.charAt(0)?"/"+i.pathname:i.pathname,protocol:i.protocol&&":"!=i.protocol?i.protocol:location.protocol,search:i.search,query:i.search.slice(1)}}function n(t){var i=["B","KB","MB","GB","TB"],t=parseInt(t,10),e=Math.log(t)/Math.log(1024)|0,s=(t/Math.pow(1024,e)).toFixed(2);return s+i[e]}function o(){return h}function r(t,i){return i=i.replace(/\{\{([^\}]+)\}\}/g,function(i,e){return t[e]})}function u(){return l}function a(t){var i=s(window.location.href);return t=s(t),t.hostname!==i.hostname||t.port!==i.port||t.protocol!==i.protocol}var l=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),h=!!window.FormData;i.exports={getFileSizeWithUnit:n,isSupportFileSystem:u,isSupportFormData:o,template:r,isCrossDomain:a}},{}],8:[function(t,i,e){"use strict";var s=t("../consts"),n=(t("../utils"),tui.util.defineClass({init:function(t,i){var e=t.template&&t.template.drag||s.HTML.drag;this._enableClass=t.drag&&t.drag.enableClass||s.CONF.DRAG_DEFAULT_ENABLE_CLASS,this._render(e,i),this._addEvent()},_render:function(t,i){this.$el=$(t),i.$el.append(this.$el)},_addEvent:function(){this.$el.on("dragenter",tui.util.bind(this.onDragEnter,this)),this.$el.on("dragover",tui.util.bind(this.onDragOver,this)),this.$el.on("drop",tui.util.bind(this.onDrop,this)),this.$el.on("dragleave",tui.util.bind(this.onDragLeave,this))},onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),this._enable()},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDragLeave:function(t){t.preventDefault(),t.stopPropagation(),this._disable()},onDrop:function(t){return t.preventDefault(),this._disable(),this.fire("drop",{files:t.originalEvent.dataTransfer.files}),!1},_enable:function(){this.$el.addClass(this._enableClass)},_disable:function(){this.$el.removeClass(this._enableClass)}}));tui.util.CustomEvents.mixin(n),i.exports=n},{"../consts":2,"../utils":7}],9:[function(t,i,e){"use strict";var s=t("../consts"),n=s.CONF.HIDDEN_FILE_INPUT_CLASS,o=t("../utils"),r=o.isSupportFormData(),u=tui.util.defineClass({init:function(t,i){this._uploader=t,this._target=i.formTarget,this._url=i.url,this._isBatchTransfer=i.isBatchTransfer,this._html=this._setHTML(i.template),r&&(this._isMultiple=i.isMultiple,this._useFolder=i.useFolder),this._render()},_render:function(){this.$el=$(this._html.form),this.$el.attr({action:this._url.send,method:"post",enctype:"multipart/form-data",target:r?"":this._target}),this.$fileInput=this._createFileInput(),this.$fileInput.appendTo(this.$el),this._isBatchTransfer&&(this.$submit=this._createSubmitElement(),this.$submit.appendTo(this.$el)),this._uploader.$el.append(this.$el),this._addEvent()},_setHTML:function(t){return t||(t={}),{input:t.input||s.HTML.input,submit:t.submit||s.HTML.submit,form:t.form||s.HTML.form}},_createFileInput:function(){var t={multiple:this._isMultiple?"multiple":"",fileField:this._uploader.fileField,webkitdirectory:this._useFolder?"webkitdirectory":""};return $(o.template(t,this._html.input))},_createSubmitElement:function(){return $(this._html.submit)},_addEvent:function(){var t;this._isBatchTransfer&&(t=r?tui.util.bind(function(t){t.preventDefault(),this._uploader.submit()},this):tui.util.bind(function(){this._uploader.submit()},this),this.$el.on("submit",t)),this._addInputEvent()},_addInputEvent:function(){this.$fileInput.on("change",tui.util.bind(this.onChange,this))},onChange:function(){this.$fileInput[0].value&&this.fire("change",{target:this})},resetFileInput:function(){this.$fileInput.remove(),this.$fileInput=this._createFileInput(),this.$submit?this.$submit.before(this.$fileInput):this.$el.append(this.$fileInput),this._addInputEvent()},clear:function(){this.$el.find("."+n).remove(),this.resetFileInput()}});tui.util.CustomEvents.mixin(u),i.exports=u},{"../consts":2,"../utils":7}],10:[function(t,i,e){"use strict";var s=t("../consts"),n=t("../utils"),o=tui.util.defineClass({init:function(t){this._setRoot(t),this._setItemInfo(t),this.render(t.template||s.HTML.item)},_setRoot:function(t){this._root=t.root,this._$root=t.root.$el},_setItemInfo:function(t){this.name=t.name,this.id=t.id||t.name,this._type=t.type||this._extractExtension(),this.size=t.size||"",this._btnClass="uploader_btn_delete",this._unit=t.unit||"KB"},render:function(t){var i=this._getHtml(t);this._$el=$(i),this._$root.append(this._$el),this._addEvent()},_extractExtension:function(){return this.name.split(".").pop()},_getHtml:function(t){var i={filetype:this._type,filename:this.name,filesize:this.size?n.getFileSizeWithUnit(this.size):"",deleteButtonClassName:this._btnClass};return n.template(i,t)},destroy:function(){this._removeEvent(),this._$el.remove()},_addEvent:function(){var t="."+this._btnClass,i=this._$el.find(t);i.on("click",tui.util.bind(this._onClickEvent,this))},_removeEvent:function(){var t="."+this._btnClass,i=this._$el.find(t);i.off("click")},_onClickEvent:function(){this.fire("remove",{name:this.name,id:this.id,type:"remove"})}});tui.util.CustomEvents.mixin(o),i.exports=o},{"../consts":2,"../utils":7}],11:[function(t,i,e){"use strict";var s=t("../utils"),n=t("./item"),o=tui.util.defineClass({init:function(t,i){var e=t.listInfo;this.items=[],this.$el=e.list,this.$counter=e.count,this.$size=e.size,this._uploader=i,tui.util.extend(this,t)},update:function(t){"remove"===t.type?this._removeFileItem(t):this._addFileItems(t)},updateTotalInfo:function(t){t?(this._updateTotalCount(t.count),this._updateTotalUsage(t.size)):(this._updateTotalCount(),this._updateTotalUsage())},_updateTotalCount:function(t){tui.util.isExisty(t)||(t=this.items.length),this.$counter.html(t)},_updateTotalUsage:function(t){tui.util.isExisty(t)||(t=this._getSumAllItemUsage()),tui.util.isNumber(t)&&!isNaN(t)?(t=s.getFileSizeWithUnit(t),this.$size.html(t),this.$size.show()):this.$size.hide()},_getSumAllItemUsage:function(){var t=this.items,i=0;return tui.util.forEach(t,function(t){i+=parseFloat(t.size)}),i},_addFileItems:function(t){tui.util.isArray(t)||(t=[t]),tui.util.forEach(t,function(t){this.items.push(this._createItem(t))},this)},_removeFileItem:function(t){var i=t.id;tui.util.forEach(this.items,function(t,e){return i===t.id?(t.destroy(),this.items.splice(e,1),!1):void 0},this),this.updateTotalInfo()},_createItem:function(t){var i=new n({root:this,name:t.name,size:t.size,id:t.id});return i.on("remove",this._removeFile,this),i},_removeFile:function(t){this.fire("remove",t)},clear:function(){tui.util.forEach(this.items,function(t){t.destroy()}),this.items.length=0,this.updateTotalInfo()}});tui.util.CustomEvents.mixin(o),i.exports=o},{"../utils":7,"./item":10}]},{},[1]);