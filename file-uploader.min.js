!function t(e,i,s){function n(r,a){if(!i[r]){if(!e[r]){var u="function"==typeof require&&require;if(!a&&u)return u(r,!0);if(o)return o(r,!0);var l=new Error("Cannot find module '"+r+"'");throw l.code="MODULE_NOT_FOUND",l}var h=i[r]={exports:{}};e[r][0].call(h.exports,function(t){var i=e[r][1][t];return n(i?i:t)},h,h.exports,t,e,i,s)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<s.length;r++)n(s[r]);return n}({1:[function(t,e,i){tui.util.defineNamespace("tui.component.Uploader",t("./src/js/uploader.js"))},{"./src/js/uploader.js":6}],2:[function(t,e,i){"use strict";e.exports.CONF={SIZE_UNIT:"SIZE_UNIT",ERROR:{DEFAULT:"Unknown error."},DRAG_DEFAULT_ENABLE_CLASS:"enableClass",FILE_FILED_NAME:"userfile[]",HIDDEN_FILE_INPUT_CLASS:"uploader-hidden-file-input",REQUESTER_TYPE_MODERN:"modernRequester",REQUESTER_TYPE_OLD:"oldRequester"},e.exports.HTML={form:['<form enctype="multipart/form-data" id="formData" method="post">','<input type="hidden" name="MAX_FILE_SIZE" value="3000000" />',"</form>"].join(""),input:['<input type="file" id="fileAttach" {{webkitdirectory}} name="{{fileField}}" {{multiple}} />'].join(""),submit:['<button class="batchSubmit" type="submit">SEND</button>'].join(""),item:['<li class="filetypeDisplayClass">','<span class="fileicon {{filetype}}">{{filetype}}</span>','<span class="file_name">{{filename}}</span>','<span class="file_size">{{filesize}}</span>','<button type="button" class="{{deleteButtonClassName}}">Delete</button>',"</li>"].join(""),drag:['<div class="dragzone"></div>'].join("")}},{}],3:[function(t,e,i){"use strict";var s=t("./consts").CONF.HIDDEN_FILE_INPUT_CLASS,n=tui.util.forEach,o=tui.util.hasStamp,r=tui.util.stamp,a=tui.util.defineClass({init:function(t){this.planet=t,this.files={}},store:function(t){var e,i=o(t)&&r(t);i&&(e=t.value,this.files[i+e]=t)},remove:function(t){var e=t.id+t.name,i=this.files[e];return i?(delete this.files[e],!0):!1},empty:function(){this.files={}},plant:function(){var t=this.planet;n(this.files,function(e,i){e.className=s,e.style.display="none",t.appendChild(e),delete this.files[i]},this)}});e.exports=a},{"./consts":2}],4:[function(t,e,i){"use strict";var s=t("../consts"),n=s.CONF.REQUESTER_TYPE_MODERN,o=tui.util.defineClass({init:function(t){this.uploader=t,this.formView=t.formView,this.pool=[],t.isBatchTransfer&&(this.remove=this._removeWhenBatch)},TYPE:n,store:function(t){var e=this.pool,i=tui.util.stamp,s=[];t=tui.util.toArray(t||this.formView.$fileInput[0].files),tui.util.forEach(t,function(t){var n=i(t);e.push(t),s.push({id:n,name:t.name,size:t.size})}),this.formView.resetFileInput(),this.fire("stored",s)},upload:function(){var t,e=this.formView.$el.clone(),i=this.uploader.fileField;e.find('input[type="file"]').remove(),t=new FormData(e),tui.util.forEach(this.pool,function(e){t.append(i,e)}),$.ajax({url:this.uploader.url.send,type:"POST",data:t,success:$.proxy(this._uploadSuccess,this),error:$.proxy(this._uploadError,this),processData:!1,contentType:!1}),this.clear()},clear:function(){this.pool.length=0},_removeWhenBatch:function(t){var e=this.pool,i=tui.util.hasStamp,s=tui.util.stamp,n=!1;tui.util.forEach(e,function(o,r){return i(o)&&s(o)===t.id?(e.splice(r,1),n=!0,!1):void 0}),this.fire("removed",tui.util.extend({message:n?"success":"fail"},t))},remove:function(t){$.ajax({url:uploader.url.remove,dataType:"jsonp",data:t,success:$.proxy(function(t){t.type="remove",this.fire("removed",t)},this)})},_uploadError:function(t,e,i){this.fire("error",{status:e,message:i})},_uploadSuccess:function(t){this.fire("uploaded",JSON.parse(t))}});tui.util.CustomEvents.mixin(o),e.exports=o},{"../consts":2}],5:[function(t,e,i){"use strict";var s=t("../pool"),n=t("../consts"),o=n.CONF.REQUESTER_TYPE_OLD,r=tui.util.defineClass({init:function(t){var e=t.$target;this.pool=new s(t.formView.$el[0]),this.uploader=t,this.formView=t.formView,e.on("load",$.proxy(this._onUpload,this,e)),t.isBatchTransfer&&(this.upload=this._uploadWhenBatch,this.remove=this._removeWhenBatch),t.isCrossDomain&&this._supportCrossDomain()},TYPE:o,_supportCrossDomain:function(){var t=this.uploader.$target,e=this;t[0].contentWindow.postMessage?(t.off("load",this._onUpload),this.formView.$el.append('<input type="hidden" name="messageTarget" value="'+location.protocol+"//"+location.host+'">'),$(window).on("message",function(t){var i=$.parseJSON(t.originalEvent.data);(!uploader.filterMessage||uploader.filterMessage(t.originalEvent))&&e.fire("uploaded",i)})):uploader.redirectURL&&this.formView.$el.append('<input type="hidden" name="redirectURL" value="'+uploader.redirectURL+'">')},_onUpload:function(t){var e,i;try{e=t[0].contentWindow.document.body,i=e.innerText||e.textContent,i&&this.fire("uploaded",$.parseJSON(i))}catch(s){this.fire("error",{status:s.name,message:s.message})}},store:function(){var t=this.formView.$fileInput[0],e=tui.util.stamp(t);this.pool.store(t),this.formView.resetFileInput(),this.fire("stored",[{id:e,name:t.value,size:""}])},upload:function(){this.pool.plant(),this.formView.$el.submit(),this.formView.clear(),this.clear()},_uploadWhenBatch:function(){this.pool.plant()},remove:function(t){var e=this.uploader;$.ajax({url:e.url.remove,dataType:"jsonp",data:t,success:$.proxy(function(t){t.type="remove",this.fire("removed",t)},this)})},_removeWhenBatch:function(t){var e=this.pool.remove(t);this.fire("removed",tui.util.extend({message:e?"success":"fail"},t))},clear:function(){this.pool.empty()}});tui.util.CustomEvents.mixin(r),e.exports=r},{"../consts":2,"../pool":3}],6:[function(t,e,i){"use strict";var s=t("./consts"),n=t("./utils"),o=t("./view/form"),r=t("./view/list"),a=t("./view/drag"),u=t("./requester/old"),l=t("./requester/modern"),h=s.CONF.REQUESTER_TYPE_MODERN,c=n.isSupportFormData(),f=tui.util.defineClass({init:function(t,e){this._setData(t),this.$el=e,this.fileField=this.fileField||s.CONF.FILE_FILED_NAME,this.useDrag&&!this.useFolder&&n.isSupportFileSystem()&&(this.dragView=new a(t,this)),this.formView=new o(this,t),this.listView=new r(t,this),this._setConnector(),this._addEvent(),this.isCrossDomain=n.isCrossDomain(this.url.send)},_setConnector:function(){c?this._requester=new l(this):(this.$target=this._createTargetFrame(),this.$el.append(this.$target),this._requester=new u(this))},_createTargetFrame:function(){var t=$('<iframe name="'+this.formTarget+'"></iframe>');return t.css({visibility:"hidden",position:"absolute"}),t},updateList:function(t){this.listView.update(t),this.isBatchTransfer?this.listView.updateTotalInfo(t):this.listView.updateTotalInfo()},_setData:function(t){tui.util.extend(this,t)},isCrossDomain:function(){var t=document.domain;return-1===this.url.send.indexOf(t)},errorCallback:function(t){var e;e=t&&t.msg?t.msg:s.CONF.ERROR.DEFAULT,alert(e)},sendFile:function(t){this.store(),this.submit(t)},removeFile:function(t){this._requester.remove(t)},submit:function(t){t&&this._requester.TYPE===h&&t.preventDefault(),this._requester.upload()},_addEvent:function(){this.useDrag&&this.dragView&&this.dragView.on("drop",this.store,this),this.listView.on("remove",this.removeFile,this),this.isBatchTransfer?this._addEventWhenBatchTransfer():this._addEventWhenNormalTransfer()},_addEventWhenBatchTransfer:function(){this.formView.on({change:this.store,submit:this.submit},this),this._requester.on({removed:function(t){this.updateList(t),this.fire("remove",t)},error:function(t){this.fire("error",t)},uploaded:function(t){this.clear(),this.fire("success",t)},stored:function(t){this.updateList(t),this.fire("update",t)}},this)},_addEventWhenNormalTransfer:function(){this.formView.on("change",this.sendFile,this),this._requester.on({removed:function(t){this.updateList(t),this.fire("remove",t)},error:function(t){this.fire("error",t)},uploaded:function(t){this.updateList(t.filelist),this.fire("success",t)}},this)},clear:function(){this._requester.clear(),this.formView.clear(),this.listView.clear()},store:function(t){this._requester.store(t)}});tui.util.CustomEvents.mixin(f),e.exports=f},{"./consts":2,"./requester/modern":4,"./requester/old":5,"./utils":7,"./view/drag":8,"./view/form":9,"./view/list":11}],7:[function(t,e,i){"use strict";function s(t){var e=document.createElement("a");return e.href=t,{href:e.href,host:e.host||location.host,port:"0"===e.port||""===e.port?port(e.protocol):e.port,hash:e.hash,hostname:e.hostname||location.hostname,pathname:"/"!=e.pathname.charAt(0)?"/"+e.pathname:e.pathname,protocol:e.protocol&&":"!=e.protocol?e.protocol:location.protocol,search:e.search,query:e.search.slice(1)}}function n(t){var e=["B","KB","MB","GB","TB"],t=parseInt(t,10),i=Math.log(t)/Math.log(1024)|0,s=(t/Math.pow(1024,i)).toFixed(2);return s+e[i]}function o(){return h}function r(t,e){return e=e.replace(/\{\{([^\}]+)\}\}/g,function(e,i){return t[i]})}function a(){return l}function u(t){var e=s(window.location.href);return t=s(t),t.hostname!==e.hostname||t.port!==e.port||t.protocol!==e.protocol}var l=!!(window.File&&window.FileReader&&window.FileList&&window.Blob),h=!!window.FormData;e.exports={getFileSizeWithUnit:n,isSupportFileSystem:a,isSupportFormData:o,template:r,isCrossDomain:u}},{}],8:[function(t,e,i){"use strict";var s=t("../consts"),n=(t("../utils"),tui.util.defineClass({init:function(t,e){var i=t.template&&t.template.drag||s.HTML.drag;this._enableClass=t.drag&&t.drag.enableClass||s.CONF.DRAG_DEFAULT_ENABLE_CLASS,this._render(i,e),this._addEvent()},_render:function(t,e){this.$el=$(t),e.$el.append(this.$el)},_addEvent:function(){this.$el.on("dragenter",$.proxy(this.onDragEnter,this)),this.$el.on("dragover",$.proxy(this.onDragOver,this)),this.$el.on("drop",$.proxy(this.onDrop,this)),this.$el.on("dragleave",$.proxy(this.onDragLeave,this))},onDragEnter:function(t){t.preventDefault(),t.stopPropagation(),this._enable()},onDragOver:function(t){t.preventDefault(),t.stopPropagation()},onDragLeave:function(t){t.preventDefault(),t.stopPropagation(),this._disable()},onDrop:function(t){return t.preventDefault(),this._disable(),this.fire("drop",t.originalEvent.dataTransfer.files),!1},_enable:function(){this.$el.addClass(this._enableClass)},_disable:function(){this.$el.removeClass(this._enableClass)}}));tui.util.CustomEvents.mixin(n),e.exports=n},{"../consts":2,"../utils":7}],9:[function(t,e,i){"use strict";var s=t("../consts"),n=t("../utils"),o=n.isSupportFormData(),r=s.CONF.HIDDEN_FILE_INPUT_CLASS,a=tui.util.defineClass({init:function(t,e){this._uploader=t,this._target=e.formTarget,this._url=e.url,this._isBatchTransfer=e.isBatchTransfer,this._html=this._setHTML(e.template),o&&(this._isMultiple=e.isMultiple,this._useFolder=e.useFolder),this._render()},_render:function(){this.$el=$(this._html.form),this.$el.attr({action:this._url.send,method:"post",enctype:"multipart/form-data",target:o?"":this._target}),this.$fileInput=this._createFileInput(),this.$fileInput.appendTo(this.$el),this._isBatchTransfer&&(this.$submit=this._createSubmitElement(),this.$submit.appendTo(this.$el)),this._uploader.$el.append(this.$el),this._addEvent()},_setHTML:function(t){return t||(t={}),{input:t.input||s.HTML.input,submit:t.submit||s.HTML.submit,form:t.form||s.HTML.form}},_createFileInput:function(){var t={multiple:this._isMultiple?"multiple":"",fileField:this._uploader.fileField,webkitdirectory:this._useFolder?"directory mozdirectory webkitdirectory":""};return $(n.template(t,this._html.input))},_createSubmitElement:function(){return $(this._html.submit)},_addEvent:function(){this._isBatchTransfer&&this._addEventWhenBatchTransfer(),this._addInputEvent()},_addEventWhenBatchTransfer:function(){this.$el.on("submit",$.proxy(function(t){this.fire("submit",t)},this))},_addInputEvent:function(){this.$fileInput.on("change",$.proxy(this.onChange,this)),this.$fileInput.attr("title"," ")},onChange:function(){this.$fileInput[0].value&&this.fire("change")},resetFileInput:function(){this.$fileInput.remove(),this.$fileInput=this._createFileInput(),this.$submit?this.$submit.before(this.$fileInput):this.$el.append(this.$fileInput),this._addInputEvent()},clear:function(){this.$el.find("."+r).remove(),this.resetFileInput()}});tui.util.CustomEvents.mixin(a),e.exports=a},{"../consts":2,"../utils":7}],10:[function(t,e,i){"use strict";var s=t("../consts"),n=t("../utils"),o=tui.util.defineClass({init:function(t){this._setRoot(t),this._setItemInfo(t),this.render(t.template||s.HTML.item)},_setRoot:function(t){this._root=t.root,this._$root=t.root.$el},_setItemInfo:function(t){this.name=t.name,this.id=t.id||t.name,this._type=t.type||this._extractExtension(),this.size=t.size||"",this._btnClass="uploader_btn_delete",this._unit=t.unit||"KB"},render:function(t){var e=this._getHtml(t);this._$el=$(e),this._$root.append(this._$el),this._addEvent()},_extractExtension:function(){return this.name.split(".").pop()},_getHtml:function(t){var e={filetype:this._type,filename:this.name,filesize:this.size?n.getFileSizeWithUnit(this.size):"",deleteButtonClassName:this._btnClass};return n.template(e,t)},destroy:function(){this._removeEvent(),this._$el.remove()},_addEvent:function(){var t="."+this._btnClass,e=this._$el.find(t);e.on("click",$.proxy(this._onClickEvent,this))},_removeEvent:function(){var t="."+this._btnClass,e=this._$el.find(t);e.off("click",this._onClickEvent)},_onClickEvent:function(){this.fire("remove",{name:this.name,id:this.id,type:"remove"})}});tui.util.CustomEvents.mixin(o),e.exports=o},{"../consts":2,"../utils":7}],11:[function(t,e,i){"use strict";var s=t("../utils"),n=t("./item"),o=tui.util.defineClass({init:function(t,e){var i=t.listInfo;this.items=[],this.$el=i.list,this.$counter=i.count,this.$size=i.size,this._uploader=e,tui.util.extend(this,t)},update:function(t){"remove"===t.type?this._removeFileItem(t):this._addFileItems(t)},updateTotalInfo:function(t){t?(this._updateTotalCount(t.count),this._updateTotalUsage(t.size)):(this._updateTotalCount(),this._updateTotalUsage())},_updateTotalCount:function(t){tui.util.isExisty(t)||(t=this.items.length),this.$counter.html(t)},_updateTotalUsage:function(t){tui.util.isExisty(t)||(t=this._getSumAllItemUsage()),tui.util.isNumber(t)&&!isNaN(t)?(t=s.getFileSizeWithUnit(t),this.$size.html(t),this.$size.show()):this.$size.hide()},_getSumAllItemUsage:function(){var t=this.items,e=0;return tui.util.forEach(t,function(t){e+=parseFloat(t.size)}),e},_addFileItems:function(t){tui.util.isArraySafe(t)||(t=[t]),tui.util.forEach(t,function(t){this.items.push(this._createItem(t))},this)},_removeFileItem:function(t){var e=t.id;tui.util.forEach(this.items,function(t,i){return e===t.id?(t.destroy(),this.items.splice(i,1),!1):void 0},this)},_createItem:function(t){var e=new n({root:this,name:t.name,size:t.size,id:t.id});return e.on("remove",this._removeFile,this),e},_removeFile:function(t){this.fire("remove",t)},clear:function(){tui.util.forEach(this.items,function(t){t.destroy()}),this.items.length=0,this.updateTotalInfo()}});tui.util.CustomEvents.mixin(o),e.exports=o},{"../utils":7,"./item":10}]},{},[1]);